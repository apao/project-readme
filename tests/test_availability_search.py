from readme import availability_search

SCCL_AVAILABILITY_HTML = u'<div class="content-header">\n  <button type="button" class="close close_top_right" data-js="close_button">\n    <span aria-hidden="true">&times;</span>\n  </button>\n  <h4 class="content-title" id="modal_label">\n    Availability for...\n  </h4>\n</div>\n<div class="content-body">\n  <div id="availabilityInfo_1302697426" testid="availability_info_modal">\n<a name="modaltop"></a>\n\n  <div class="bib_title" testid="availability_title">\n    <div class="modal_bib_display">\n  <div class="bib_image" data-js="modal_bib_image">\n    <div class=\'jacketCoverDiv\'><img alt="When A Scot Ties the Knot" class="jacketCover medium" data-js="" fallback="//cor-liv-cdn-static.bibliocommons.com/assets/default_covers/icon-book-283a0480230233b37819a4a4ea9b23c5.png" id="1734852103" src="https://contentcafe2.btol.com/ContentCafe/Jacket.aspx?&amp;userID=SNCL11730&amp;password=CC95008&amp;Value=9780062349026&amp;content=S&amp;Return=1&amp;Type=S" title="When A Scot Ties the Knot" /></div> \n  </div>\n  <div class="title">\n    <span class="title"><a href="/item/show/1734852103_when_a_scot_ties_the_knot" target="_parent" testid="bib_link" title="When A Scot Ties the Knot (Book)">When A Scot Ties the Knot</a></span>\n  </div>\n  <div class="authors">\n    \n\t  <span class="author">\n       By <a href="/search?q=%22Dare%2C+Tessa%22&amp;search_category=author&amp;search_scope=CAL-SCCL&amp;t=author" target="_parent" testid="author_search">Dare, Tessa</a>\n\t  </span>\n\n  </div>\n  <div class="format_and_date">\n    \t<span class="format">\n        \n\t\t<strong>Book</strong>\n     - 2015        \n     \n\t</span>\n\n  </div>\n  \n</div>\n    <div class="messaging inPage" id="id_69l1k6k87mqkdqru4a8hvuhlij" role="alert">\n  <div class="messageContent">\n    <span class="message-icon"></span>\n    <p id="msg_id_7g7r0lo2cmcsnlpmkar7eqqf8i" class="first">\n      <a name="cached_items_modal"></a>\n    </p>\n  </div>\n</div>\n<script type="text/javascript" charset="utf-8">\n\tregistered_messages.push({element: \'msg_id_7g7r0lo2cmcsnlpmkar7eqqf8i\', key: ["cached_items_modal"], type: ["message","error"]});\n</script>\n \n      <span class="hide_in_overlay">\n        Total Copies: 7\n      </span>\n\t</div>\n\n\n\n\t<div id="availabilityInfoContent" class="tab-content">\n\t<!-- begin CIRCULATION DETAILS TAB -->\n\t\t<div id="circulation_details" class="circulation_details circBody tab-pane clearfix active">\n\t\t  <br>\n      <div class="branch" testid="availability_branch">\n\n            <a name="group0"></a>\n            <h1 class="group_heading" testid="availability_group_heading">Available (3)</h1>\n            <div class="table-responsive">\n  <table class="table">    \n    <thead>  \n      <tr>\n         <th class="library" scope="col">Location</th>  \n        <th scope="col" class="collection">Collection</th>\n        \n        \n          <th scope="col" class="call_no">Call No</th>\n        <th scope="col" class="status">Status</th>\n        \n      </tr>\n    </thead> \n    <tbody>\n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Cupertino  </td>\n          <td testid="item_collection"> Cupertino Adult - Romance Section </td>\n          <td testid="item_call_number"> ROMANCE DARE TESSA  </td>\n            <td testid="item_status">\n            Available\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Milpitas  </td>\n          <td testid="item_collection"> Milpitas Adult - Romance Section </td>\n          <td testid="item_call_number"> ROMANCE DARE TESSA  </td>\n            <td testid="item_status">\n            Available\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Morgan Hill  </td>\n          <td testid="item_collection"> Morgan Hill Adult - Romance Section </td>\n          <td testid="item_call_number"> ROMANCE DARE TESSA  </td>\n            <td testid="item_status">\n            Available\n          </td>\n        </tr>\n  \n     </tbody>                        \n  </table>\n</div>  \n\n\n            <a name="group1"></a>\n            <h1 class="group_heading" testid="availability_group_heading">Not available at this time (4)</h1>\n            <div class="table-responsive">\n  <table class="table">    \n    <thead>  \n      <tr>\n         <th class="library" scope="col">Location</th>  \n        <th scope="col" class="collection">Collection</th>\n        \n        \n          <th scope="col" class="call_no">Call No</th>\n        <th scope="col" class="status">Status</th>\n        \n      </tr>\n    </thead> \n    <tbody>\n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Campbell  </td>\n          <td testid="item_collection"> Campbell Adult - Romance Section </td>\n          <td testid="item_call_number"> ROMANCE DARE TESSA  </td>\n            <td testid="item_status">\n            Due 04-01-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Gilroy  </td>\n          <td testid="item_collection"> Gilroy Adult - New Book Section </td>\n          <td testid="item_call_number"> ROMANCE DARE TESSA  </td>\n            <td testid="item_status">\n            In Transit\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Los Altos  </td>\n          <td testid="item_collection"> Los Altos Adult - Romance Section </td>\n          <td testid="item_call_number"> ROMANCE DARE TESSA  </td>\n            <td testid="item_status">\n            Due 04-08-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Saratoga  </td>\n          <td testid="item_collection"> Saratoga Adult - New Book Section </td>\n          <td testid="item_call_number"> ROMANCE DARE TESSA  </td>\n            <td testid="item_status">\n            Due 03-28-16\n          </td>\n        </tr>\n  \n     </tbody>                        \n  </table>\n</div>  \n\n\n      </div>\n    </div>\n\t<!-- end CIRCULATION DETAILS -->\n\t\n\t\n\n\t\n\n  </div>\n</div>\n<script type="text/javascript" charset="utf-8">\n\tvar availabilityTabs  = "#availabilityInfo_1302697426";\n</script>\n\n</div>\n  <div class="content-footer">\n      <button href="javascript:void(0);" class="btn btn-default" data-js="close_button" testid="modal_footer_close_button">Close</button>\n  </div>\n'

SMCL_AVAILABILITY_HTML = u'<div class="content-header">\n  <button type="button" class="close close_top_right" data-js="close_button">\n    <span aria-hidden="true">&times;</span>\n  </button>\n  <h4 class="content-title" id="modal_label">\n    Availability for...\n  </h4>\n</div>\n<div class="content-body">\n  <div id="availabilityInfo_829487214" testid="availability_info_modal">\n<a name="modaltop"></a>\n\n  <div class="bib_title" testid="availability_title">\n    <div class="modal_bib_display">\n  <div class="bib_image" data-js="modal_bib_image">\n    <div class=\'jacketCoverDiv\'><img alt="Lean in" class="jacketCover medium" data-js="" fallback="//cor-liv-cdn-static.bibliocommons.com/assets/default_covers/icon-book-283a0480230233b37819a4a4ea9b23c5.png" id="2172164076" src="https://contentcafe2.btol.com/ContentCafe/Jacket.aspx?&amp;userID=PLS55484&amp;password=CC90878&amp;Value=9780385349949&amp;content=S&amp;Return=1&amp;Type=S" title="Lean in" /></div> \n  </div>\n  <div class="title">\n    <span class="title"><a href="/item/show/2172164076_lean_in" target="_parent" testid="bib_link" title="Lean in - Women, Work, and the Will to Lead (Book)">Lean in</a></span>\n  </div>\n  <div class="authors">\n    \n\t  <span class="author">\n       By <a href="/search?q=%22Sandberg%2C+Sheryl%22&amp;search_category=author&amp;search_scope=all&amp;t=author" target="_parent" testid="author_search">Sandberg, Sheryl</a>\n\t  </span>\n\n  </div>\n  <div class="format_and_date">\n    \t<span class="format">\n        \n\t\t<strong>Book</strong>\n     - 2013        \n     \n\t</span>\n\n  </div>\n  \n</div>\n    <div class="messaging inPage" id="id_5pbdt4vpptvo4lj855imdotmu4" role="alert">\n  <div class="messageContent">\n    <span class="message-icon"></span>\n    <p id="msg_id_2nq7q3tu46ghpd40on87s6v754" class="first">\n      <a name="cached_items_modal"></a>\n    </p>\n  </div>\n</div>\n<script type="text/javascript" charset="utf-8">\n\tregistered_messages.push({element: \'msg_id_2nq7q3tu46ghpd40on87s6v754\', key: ["cached_items_modal"], type: ["message","error"]});\n</script>\n \n      <span class="hide_in_overlay">\n        Total Copies: 45\n      </span>\n\t</div>\n\n\n\n\t<div id="availabilityInfoContent" class="tab-content">\n\t<!-- begin CIRCULATION DETAILS TAB -->\n\t\t<div id="circulation_details" class="circulation_details circBody tab-pane clearfix active">\n\t\t  <br>\n      <div class="branch" testid="availability_branch">\n\n            <a name="group0"></a>\n            <h1 class="group_heading" testid="availability_group_heading">Available (13)</h1>\n            <div class="table-responsive">\n  <table class="table">    \n    <thead>  \n      <tr>\n         <th class="library" scope="col">Location</th>  \n        <th scope="col" class="collection">Collection</th>\n        \n        \n          <th scope="col" class="call_no">Call No</th>\n        <th scope="col" class="status">Status</th>\n        \n      </tr>\n    </thead> \n    <tbody>\n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Atherton  </td>\n          <td testid="item_collection"> Atherton Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Ca\xf1ada College  </td>\n          <td testid="item_collection"> Ca\xf1ada College Circulating Collection </td>\n          <td testid="item_call_number"> HD6054.3.S265 2013  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> College of San Mateo  </td>\n          <td testid="item_collection"> College of San Mateo Circulating Collection </td>\n          <td testid="item_call_number"> HD6054.3 .S265 2013  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Daly City-Bayshore  </td>\n          <td testid="item_collection"> Daly City - Bayshore - Nonfiction </td>\n          <td testid="item_call_number"> 658.409082 SAN  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> East Palo Alto  </td>\n          <td testid="item_collection"> East Palo Alto Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Menlo Park-Main  </td>\n          <td testid="item_collection"> Menlo Park - Main Young Adult Nonfiction </td>\n          <td testid="item_call_number"> YP 658.4092 SAN  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Millbrae  </td>\n          <td testid="item_collection"> Millbrae Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Pacifica-Sanchez  </td>\n          <td testid="item_collection"> Pacifica-Sanchez Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Pacifica-Sharp Park  </td>\n          <td testid="item_collection"> Pacifica-Sharp Park Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Portola Valley  </td>\n          <td testid="item_collection"> Portola Valley Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> San Bruno  (2)</td>\n          <td testid="item_collection"> San Bruno Nonfiction </td>\n          <td testid="item_call_number"> 658.4092 SAN  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> South San Francisco-Main  </td>\n          <td testid="item_collection"> South San Francisco - Main Nonfiction </td>\n          <td testid="item_call_number"> 658.4 SAN  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n     </tbody>                        \n  </table>\n</div>  \n\n\n            <a name="group1"></a>\n            <h1 class="group_heading" testid="availability_group_heading">Not available at this time (32)</h1>\n            <div class="table-responsive">\n  <table class="table">    \n    <thead>  \n      <tr>\n         <th class="library" scope="col">Location</th>  \n        <th scope="col" class="collection">Collection</th>\n        \n        \n          <th scope="col" class="call_no">Call No</th>\n        <th scope="col" class="status">Status</th>\n        \n      </tr>\n    </thead> \n    <tbody>\n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Belmont  </td>\n          <td testid="item_collection"> Belmont Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            IN TRANSIT\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Belmont  (2)</td>\n          <td testid="item_collection"> Belmont Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            Due 03-27-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Brisbane  </td>\n          <td testid="item_collection"> Brisbane Nonfiction   </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            ON HOLD SHELF\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Burlingame-Easton  </td>\n          <td testid="item_collection"> Burlingame - Easton Nonfiction </td>\n          <td testid="item_call_number"> 658.4092 Sa562L  </td>\n            <td testid="item_status">\n            Due 04-04-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Burlingame-Main  </td>\n          <td testid="item_collection"> Burlingame Nonfiction - Lower Level </td>\n          <td testid="item_call_number"> 658.4092 Sa562L  </td>\n            <td testid="item_status">\n            Due 04-01-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Burlingame-Main  </td>\n          <td testid="item_collection"> Burlingame Nonfiction - Lower Level </td>\n          <td testid="item_call_number"> 658.4092 Sa562L  </td>\n            <td testid="item_status">\n            Due 03-30-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Daly City-John Daly  </td>\n          <td testid="item_collection"> Daly City - John Daly - Nonfiction  </td>\n          <td testid="item_call_number"> 658.409082 SAN  </td>\n            <td testid="item_status">\n            Due 04-06-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Daly City-Serramonte  </td>\n          <td testid="item_collection"> Daly City - Serramonte - Nonfiction </td>\n          <td testid="item_call_number"> 658.409082 SAN  </td>\n            <td testid="item_status">\n            Due 03-22-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Daly City-Westlake  </td>\n          <td testid="item_collection"> Daly City - Westlake - Nonfiction </td>\n          <td testid="item_call_number"> 658.409082 SAN  </td>\n            <td testid="item_status">\n            MISSING\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Foster City  </td>\n          <td testid="item_collection"> Foster City Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            Due 03-23-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Foster City  </td>\n          <td testid="item_collection"> Foster City Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            Due 03-29-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Foster City  </td>\n          <td testid="item_collection"> Foster City Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            Due 03-26-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Half Moon Bay  </td>\n          <td testid="item_collection"> Half Moon Bay Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            Due 04-01-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Menlo Park-Main  </td>\n          <td testid="item_collection"> Menlo Park - Main Nonfiction </td>\n          <td testid="item_call_number"> 658.4092 SAN  </td>\n            <td testid="item_status">\n            Due 03-29-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Menlo Park-Main  </td>\n          <td testid="item_collection"> Menlo Park - Main Nonfiction </td>\n          <td testid="item_call_number"> 658.4092 SAN  </td>\n            <td testid="item_status">\n            Due 05-02-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Menlo Park-Main  </td>\n          <td testid="item_collection"> Menlo Park - Main Nonfiction </td>\n          <td testid="item_call_number"> 658.4092 SAN  </td>\n            <td testid="item_status">\n            MISSING\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Millbrae  (2)</td>\n          <td testid="item_collection"> Millbrae Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            Due 03-26-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Redwood City-Downtown  </td>\n          <td testid="item_collection"> Redwood City - Downtown Adult Nonfiction </td>\n          <td testid="item_call_number"> 658.4 SANDBERG  </td>\n            <td testid="item_status">\n            Due 04-07-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Redwood City-Downtown  </td>\n          <td testid="item_collection"> Redwood City - Downtown Adult Nonfiction </td>\n          <td testid="item_call_number"> 658.4 SANDBERG  </td>\n            <td testid="item_status">\n            Due 03-23-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Redwood City-Downtown  </td>\n          <td testid="item_collection"> Redwood City - Downtown Adult Nonfiction </td>\n          <td testid="item_call_number"> 658.4 SANDBERG  </td>\n            <td testid="item_status">\n            Due 03-29-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Redwood City-Fair Oaks  </td>\n          <td testid="item_collection"> Redwood City - Fair Oaks Nonfiction </td>\n          <td testid="item_call_number"> 658.4 SANDBERG  </td>\n            <td testid="item_status">\n            Due 04-07-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Redwood City-Redwood Shores  </td>\n          <td testid="item_collection"> Redwood City - Redwood Shores Adult Nonfiction </td>\n          <td testid="item_call_number"> 658.4 SANDBERG  </td>\n            <td testid="item_status">\n            Due 03-30-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Redwood City-Schaberg  </td>\n          <td testid="item_collection"> Redwood City - Schaberg Nonfiction </td>\n          <td testid="item_call_number"> 658.4 SANDBERG  </td>\n            <td testid="item_status">\n            Due 04-06-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> San Carlos  </td>\n          <td testid="item_collection"> San Carlos Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            Due 04-07-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> San Carlos  </td>\n          <td testid="item_collection"> San Carlos Nonfiction </td>\n          <td testid="item_call_number"> SOC SCI ISSUE  </td>\n            <td testid="item_status">\n            Due 04-06-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> San Mateo-Hillsdale  </td>\n          <td testid="item_collection"> San Mateo - Hillsdale Nonfiction </td>\n          <td testid="item_call_number"> 658.4092 SANDB  </td>\n            <td testid="item_status">\n            Due 04-04-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> San Mateo-Main  </td>\n          <td testid="item_collection"> San Mateo Main Nonfiction 2nd Fl </td>\n          <td testid="item_call_number"> 658.4092 SANDB  </td>\n            <td testid="item_status">\n            Due 03-28-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> San Mateo-Main  </td>\n          <td testid="item_collection"> San Mateo Main Nonfiction 2nd Fl </td>\n          <td testid="item_call_number"> 658.4092 SANDB  </td>\n            <td testid="item_status">\n            Due 03-13-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Skyline College  </td>\n          <td testid="item_collection"> Skyline College Circulating Collection </td>\n          <td testid="item_call_number"> HD6054.3 .S265 2013  </td>\n            <td testid="item_status">\n            Due 04-08-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> South San Francisco-Main  </td>\n          <td testid="item_collection"> South San Francisco - Main Nonfiction </td>\n          <td testid="item_call_number"> 658.4 SAN  </td>\n            <td testid="item_status">\n            Due 04-02-16\n          </td>\n        </tr>\n  \n     </tbody>                        \n  </table>\n</div>  \n\n\n      </div>\n    </div>\n\t<!-- end CIRCULATION DETAILS -->\n\t\n\t\n\n\t\n\n  </div>\n</div>\n<script type="text/javascript" charset="utf-8">\n\tvar availabilityTabs  = "#availabilityInfo_829487214";\n</script>\n\n</div>\n  <div class="content-footer">\n      <button href="javascript:void(0);" class="btn btn-default" data-js="close_button" testid="modal_footer_close_button">Close</button>\n  </div>\n'

SFPL_AVAILABILITY_HTML = u'<div class="content-header">\n  <button type="button" class="close close_top_right" data-js="close_button">\n    <span aria-hidden="true">&times;</span>\n  </button>\n  <h4 class="content-title" id="modal_label">\n    Availability for...\n  </h4>\n</div>\n<div class="content-body">\n  <div id="availabilityInfo_1014382288" testid="availability_info_modal">\n<a name="modaltop"></a>\n\n  <div class="bib_title" testid="availability_title">\n    <div class="modal_bib_display">\n  <div class="bib_image" data-js="modal_bib_image">\n    <div class=\'jacketCoverDiv\'><img alt="Grain Brain" class="jacketCover medium" data-js="" fallback="//cor-liv-cdn-static.bibliocommons.com/assets/default_covers/icon-book-283a0480230233b37819a4a4ea9b23c5.png" id="2639275093" src="https://secure.syndetics.com/index.aspx?isbn=9780316234801/SC.GIF&amp;client=sfpl&amp;type=xw12&amp;oclc=" title="Grain Brain" /></div> \n  </div>\n  <div class="title">\n    <span class="title"><a href="/item/show/2639275093_grain_brain" target="_parent" testid="bib_link" title="Grain Brain - The Surprising Truth About Wheat, Carbs, and Sugar--your Brain\'s Silent Killers (Book)">Grain Brain</a></span>\n  </div>\n  <div class="authors">\n    \n\t  <span class="author">\n       By <a href="/search?q=%22Perlmutter%2C+David%22&amp;search_category=author&amp;search_scope=CAL-SFPL&amp;t=author" target="_parent" testid="author_search">Perlmutter, David</a>\n\t  </span>\n\n  </div>\n  <div class="format_and_date">\n    \t<span class="format">\n        \n\t\t<strong>Book</strong>\n     - 2013        \n     \n\t</span>\n\n  </div>\n  \n</div>\n    <div class="messaging inPage" id="id_3b17o2sjjjil5dssjtknup9kuk" role="alert">\n  <div class="messageContent">\n    <span class="message-icon"></span>\n    <p id="msg_id_657jthg9n5bsqu8nah5un0gss1" class="first">\n      <a name="cached_items_modal"></a>\n    </p>\n  </div>\n</div>\n<script type="text/javascript" charset="utf-8">\n\tregistered_messages.push({element: \'msg_id_657jthg9n5bsqu8nah5un0gss1\', key: ["cached_items_modal"], type: ["message","error"]});\n</script>\n \n      <span class="hide_in_overlay">\n        Total Copies: 30\n      </span>\n\t</div>\n\n\n\n\t<div id="availabilityInfoContent" class="tab-content">\n\t<!-- begin CIRCULATION DETAILS TAB -->\n\t\t<div id="circulation_details" class="circulation_details circBody tab-pane clearfix active">\n\t\t  <br>\n      <div class="branch" testid="availability_branch">\n\n            <a name="group0"></a>\n            <h1 class="group_heading" testid="availability_group_heading">Available (12)</h1>\n            <div class="table-responsive">\n  <table class="table">    \n    <thead>  \n      <tr>\n         <th class="library" scope="col">Location</th>  \n        <th scope="col" class="collection">Collection</th>\n        \n        \n          <th scope="col" class="call_no">Call No</th>\n        <th scope="col" class="status">Status</th>\n        \n      </tr>\n    </thead> \n    <tbody>\n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Bernal Heights Branch  </td>\n          <td testid="item_collection"> BERNAL HEIGHTS BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Eureka Valley Branch  </td>\n          <td testid="item_collection"> EUREKA VALLEY BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Ingleside Branch  </td>\n          <td testid="item_collection"> INGLESIDE BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Main Library  </td>\n          <td testid="item_collection"> MAIN - 4th Floor </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Mission Bay Branch  (2)</td>\n          <td testid="item_collection"> MISSION BAY BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Mission Branch  </td>\n          <td testid="item_collection"> MISSION  BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Ortega Branch  </td>\n          <td testid="item_collection"> ORTEGA BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Park Branch  </td>\n          <td testid="item_collection"> PARK BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Parkside Branch  </td>\n          <td testid="item_collection"> PARKSIDE BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Portola Branch  </td>\n          <td testid="item_collection"> PORTOLA BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Western Addition Branch  </td>\n          <td testid="item_collection"> WESTERN ADDITION BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            CHECK SHELF\n          </td>\n        </tr>\n  \n     </tbody>                        \n  </table>\n</div>  \n\n\n            <a name="group1"></a>\n            <h1 class="group_heading" testid="availability_group_heading">Not available at this time (18)</h1>\n            <div class="table-responsive">\n  <table class="table">    \n    <thead>  \n      <tr>\n         <th class="library" scope="col">Location</th>  \n        <th scope="col" class="collection">Collection</th>\n        \n        \n          <th scope="col" class="call_no">Call No</th>\n        <th scope="col" class="status">Status</th>\n        \n      </tr>\n    </thead> \n    <tbody>\n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Anza Branch  </td>\n          <td testid="item_collection"> ANZA BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            Due 03-26-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Bayview Branch  </td>\n          <td testid="item_collection"> BAYVIEW BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            ON HOLDSHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Glen Park Branch  </td>\n          <td testid="item_collection"> GLEN PARK BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            MISSING\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Golden Gate Valley Branch  </td>\n          <td testid="item_collection"> GOLDEN GATE VALLEY BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            Due 02-27-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Main Library  </td>\n          <td testid="item_collection"> MAIN - 4th Floor </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            Due 04-09-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Marina Branch  </td>\n          <td testid="item_collection"> MARINA BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            Due 04-04-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Merced Branch  </td>\n          <td testid="item_collection"> MERCED -- NEW BOOKS </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            Due 03-22-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Mission Branch  </td>\n          <td testid="item_collection"> MISSION  BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            LOST AND PAID\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Noe Valley Branch  </td>\n          <td testid="item_collection"> NOE VALLEY BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            IN TRANSIT\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> North Beach Branch  </td>\n          <td testid="item_collection"> NORTH BEACH BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            MISSING\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Potrero Branch  </td>\n          <td testid="item_collection"> POTRERO BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            DAMAGED/REPAIR\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Presidio Branch  </td>\n          <td testid="item_collection"> PRESIDIO BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            Due 04-05-16\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Presidio Branch  </td>\n          <td testid="item_collection"> PRESIDIO BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            Due 03-25-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Richmond Branch  </td>\n          <td testid="item_collection"> RICHMOND BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            ON HOLDSHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> Sunset Branch  </td>\n          <td testid="item_collection"> SUNSET BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            IN TRANSIT\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Visitacion Valley Branch  </td>\n          <td testid="item_collection"> VISITACION VALLEY BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            ON HOLDSHELF\n          </td>\n        </tr>\n  \n        <tr class="odd">\n          <td testid="item_branch_name" scope="row"> West Portal Branch  </td>\n          <td testid="item_collection"> WEST PORTAL BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            Due 04-03-16\n          </td>\n        </tr>\n  \n        <tr class="even">\n          <td testid="item_branch_name" scope="row"> Western Addition Branch  </td>\n          <td testid="item_collection"> WESTERN ADDITION BRANCH </td>\n          <td testid="item_call_number"> 613.26 P4222g  </td>\n            <td testid="item_status">\n            Due 04-07-16\n          </td>\n        </tr>\n  \n     </tbody>                        \n  </table>\n</div>  \n\n\n      </div>\n    </div>\n\t<!-- end CIRCULATION DETAILS -->\n\t\n\t\n\n\t\n\n  </div>\n</div>\n<script type="text/javascript" charset="utf-8">\n\tvar availabilityTabs  = "#availabilityInfo_1014382288";\n</script>\n\n</div>\n  <div class="content-footer">\n      <button href="javascript:void(0);" class="btn btn-default" data-js="close_button" testid="modal_footer_close_button">Close</button>\n  </div>\n'

GRAIN_BRAIN_ISBN = "9780316234801"

class _TestBaseBibliocommonsAvailabilitySearch(object):
    """Core tests for Bibliocommons-based library catalog search."""
    availability_search_cls = availability_search.BaseBibliocommonsAvailabilitySearch
    availability_html = None
    serp_html = None

    expected_search_url = None
    expected_avail_url = None

    expected_avail_list = []


    def test_populate_availability_by_avail_url(self):
        searcher = self.availability_search_cls()

        actual_avail_list = []

        result = searcher.populate_availability_by_avail_url(self.availability_html, actual_avail_list)
        assert actual_avail_list == result
        assert type(actual_avail_list) == list

        assert len(actual_avail_list) == len(self.expected_avail_list)

        # Tests for ordering AND item equivalence
        for actual_item, expected_item in zip(actual_avail_list, self.expected_avail_list):
            assert type(actual_item) == dict
            assert actual_item == expected_item


    def test_create_search_url(self):
        searcher = self.availability_search_cls()

        actual_search_url = searcher.create_search_url(GRAIN_BRAIN_ISBN)
        assert actual_search_url == self.expected_search_url


    def test_get_avail_url_from_serp(self):
        searcher = self.availability_search_cls()

        search_results_page_html = self.serp_html

        actual_avail_url = searcher.get_avail_url_from_serp(search_results_page_html)
        assert actual_avail_url == self.expected_avail_url


class TestSCCLLibraryAvailabilitySearch(_TestBaseBibliocommonsAvailabilitySearch):
    availability_search_cls = availability_search.SCCLAvailabilitySearch
    availability_html = SCCL_AVAILABILITY_HTML

    expected_search_url = 'https://sccl.bibliocommons.com/search?utf8=%E2%9C%93&t=smart&search_category=keyword&q=9780316234801&commit=Search&searchOpt=catalogue'

    serp_html = """<div class="col-sm-5 text_right_sm availability_block">
                        <span class="label availability">
                    <span role="presentation" class="item_available" testid="item_availability">Available </span>
                    <a href="/item/show_circulation/1424563103?search_scope=CAL-SCCL" class="circInfo value underlined" id="circ_info_trigger_1424563103_0.29898371237261956" role="button" testid="availability_details">in some locations</a>

            </span>
            <span class="label">

            </span>

      </div>"""

    expected_avail_url = 'https://sccl.bibliocommons.com/item/show_circulation/1424563103.json?search_scope=CAL-SCCL'

    expected_avail_list = [
         {'branch_name': 'Cupertino',
          'branch_section': 'Cupertino Adult - Romance Section',
          'call_no': 'ROMANCE DARE TESSA',
          'num_of_copies': 1,
          'status': 'Available'},
         {'branch_name': 'Milpitas',
          'branch_section': 'Milpitas Adult - Romance Section',
          'call_no': 'ROMANCE DARE TESSA',
          'num_of_copies': 1,
          'status': 'Available'},
         {'branch_name': 'Morgan Hill',
          'branch_section': 'Morgan Hill Adult - Romance Section',
          'call_no': 'ROMANCE DARE TESSA',
          'num_of_copies': 1,
          'status': 'Available'},
         {'branch_name': 'Campbell',
          'branch_section': 'Campbell Adult - Romance Section',
          'call_no': 'ROMANCE DARE TESSA',
          'num_of_copies': 1,
          'status': 'Due 04-01-16'},
         {'branch_name': 'Gilroy',
          'branch_section': 'Gilroy Adult - New Book Section',
          'call_no': 'ROMANCE DARE TESSA',
          'num_of_copies': 1,
          'status': 'In Transit'},
         {'branch_name': 'Los Altos',
          'branch_section': 'Los Altos Adult - Romance Section',
          'call_no': 'ROMANCE DARE TESSA',
          'num_of_copies': 1,
          'status': 'Due 04-08-16'},
         {'branch_name': 'Saratoga',
          'branch_section': 'Saratoga Adult - New Book Section',
          'call_no': 'ROMANCE DARE TESSA',
          'num_of_copies': 1,
          'status': 'Due 03-28-16'}
    ]

    def test_create_search_url(self):
        super(TestSCCLLibraryAvailabilitySearch, self).test_create_search_url()


class TestSMCLLibraryAvailabilitySearch(_TestBaseBibliocommonsAvailabilitySearch):
    availability_search_cls = availability_search.SMCLAvailabilitySearch
    availability_html = SMCL_AVAILABILITY_HTML

    expected_search_url = 'https://smcl.bibliocommons.com/search?locale=en-US&t=smart&q=9780316234801'

    serp_html = """<div class="col-sm-5 text_right_sm availability_block">
                        <span class="label availability">
                    <span role="presentation" class="item_available" testid="item_availability">Available </span>
                    <a href="/item/show_circulation/2193997076?search_scope=all" class="circInfo value underlined" id="circ_info_trigger_2193997076_0.8898293159245265" role="button" testid="availability_details">in some locations</a>

            </span>
            <span class="label">

            </span>

      </div>"""

    expected_avail_url = 'https://smcl.bibliocommons.com/item/show_circulation/2193997076.json?search_scope=all'

    expected_avail_list = [
         {'branch_name': 'Atherton',
          'branch_section': 'Atherton Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'CHECK SHELF'},
         {'branch_name': u'Ca\xf1ada College',
          'branch_section': u'Ca\xf1ada College Circulating Collection',
          'call_no': 'HD6054.3.S265 2013',
          'num_of_copies': 1,
          'status': 'CHECK SHELF'},
         {'branch_name': 'College of San Mateo',
          'branch_section': 'College of San Mateo Circulating Collection',
          'call_no': 'HD6054.3 .S265 2013',
          'num_of_copies': 1,
          'status': 'CHECK SHELF'},
         {'branch_name': 'Daly City-Bayshore',
          'branch_section': 'Daly City - Bayshore - Nonfiction',
          'call_no': '658.409082 SAN',
          'num_of_copies': 1,
          'status': 'CHECK SHELF'},
         {'branch_name': 'East Palo Alto',
          'branch_section': 'East Palo Alto Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'CHECK SHELF'},
         {'branch_name': 'Menlo Park-Main',
          'branch_section': 'Menlo Park - Main Young Adult Nonfiction',
          'call_no': 'YP 658.4092 SAN',
          'num_of_copies': 1,
          'status': 'CHECK SHELF'},
         {'branch_name': 'Millbrae',
          'branch_section': 'Millbrae Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'CHECK SHELF'},
         {'branch_name': 'Pacifica-Sanchez',
          'branch_section': 'Pacifica-Sanchez Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'CHECK SHELF'},
         {'branch_name': 'Pacifica-Sharp Park',
          'branch_section': 'Pacifica-Sharp Park Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'CHECK SHELF'},
         {'branch_name': 'Portola Valley',
          'branch_section': 'Portola Valley Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'CHECK SHELF'},
         {'branch_name': 'San Bruno',
          'branch_section': 'San Bruno Nonfiction',
          'call_no': '658.4092 SAN',
          'num_of_copies': 2,
          'status': 'CHECK SHELF'},
         {'branch_name': 'South San Francisco-Main',
          'branch_section': 'South San Francisco - Main Nonfiction',
          'call_no': '658.4 SAN',
          'num_of_copies': 1,
          'status': 'CHECK SHELF'},
         {'branch_name': 'Belmont',
          'branch_section': 'Belmont Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'IN TRANSIT'},
         {'branch_name': 'Belmont',
          'branch_section': 'Belmont Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 2,
          'status': 'Due 03-27-16'},
         {'branch_name': 'Brisbane',
          'branch_section': 'Brisbane Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'ON HOLD SHELF'},
         {'branch_name': 'Burlingame-Easton',
          'branch_section': 'Burlingame - Easton Nonfiction',
          'call_no': '658.4092 Sa562L',
          'num_of_copies': 1,
          'status': 'Due 04-04-16'},
         {'branch_name': 'Burlingame-Main',
          'branch_section': 'Burlingame Nonfiction - Lower Level',
          'call_no': '658.4092 Sa562L',
          'num_of_copies': 1,
          'status': 'Due 04-01-16'},
         {'branch_name': 'Burlingame-Main',
          'branch_section': 'Burlingame Nonfiction - Lower Level',
          'call_no': '658.4092 Sa562L',
          'num_of_copies': 1,
          'status': 'Due 03-30-16'},
         {'branch_name': 'Daly City-John Daly',
          'branch_section': 'Daly City - John Daly - Nonfiction',
          'call_no': '658.409082 SAN',
          'num_of_copies': 1,
          'status': 'Due 04-06-16'},
         {'branch_name': 'Daly City-Serramonte',
          'branch_section': 'Daly City - Serramonte - Nonfiction',
          'call_no': '658.409082 SAN',
          'num_of_copies': 1,
          'status': 'Due 03-22-16'},
         {'branch_name': 'Daly City-Westlake',
          'branch_section': 'Daly City - Westlake - Nonfiction',
          'call_no': '658.409082 SAN',
          'num_of_copies': 1,
          'status': 'MISSING'},
         {'branch_name': 'Foster City',
          'branch_section': 'Foster City Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'Due 03-23-16'},
         {'branch_name': 'Foster City',
          'branch_section': 'Foster City Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'Due 03-29-16'},
         {'branch_name': 'Foster City',
          'branch_section': 'Foster City Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'Due 03-26-16'},
         {'branch_name': 'Half Moon Bay',
          'branch_section': 'Half Moon Bay Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'Due 04-01-16'},
         {'branch_name': 'Menlo Park-Main',
          'branch_section': 'Menlo Park - Main Nonfiction',
          'call_no': '658.4092 SAN',
          'num_of_copies': 1,
          'status': 'Due 03-29-16'},
         {'branch_name': 'Menlo Park-Main',
          'branch_section': 'Menlo Park - Main Nonfiction',
          'call_no': '658.4092 SAN',
          'num_of_copies': 1,
          'status': 'Due 05-02-16'},
         {'branch_name': 'Menlo Park-Main',
          'branch_section': 'Menlo Park - Main Nonfiction',
          'call_no': '658.4092 SAN',
          'num_of_copies': 1,
          'status': 'MISSING'},
         {'branch_name': 'Millbrae',
          'branch_section': 'Millbrae Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 2,
          'status': 'Due 03-26-16'},
         {'branch_name': 'Redwood City-Downtown',
          'branch_section': 'Redwood City - Downtown Adult Nonfiction',
          'call_no': '658.4 SANDBERG',
          'num_of_copies': 1,
          'status': 'Due 04-07-16'},
         {'branch_name': 'Redwood City-Downtown',
          'branch_section': 'Redwood City - Downtown Adult Nonfiction',
          'call_no': '658.4 SANDBERG',
          'num_of_copies': 1,
          'status': 'Due 03-23-16'},
         {'branch_name': 'Redwood City-Downtown',
          'branch_section': 'Redwood City - Downtown Adult Nonfiction',
          'call_no': '658.4 SANDBERG',
          'num_of_copies': 1,
          'status': 'Due 03-29-16'},
         {'branch_name': 'Redwood City-Fair Oaks',
          'branch_section': 'Redwood City - Fair Oaks Nonfiction',
          'call_no': '658.4 SANDBERG',
          'num_of_copies': 1,
          'status': 'Due 04-07-16'},
         {'branch_name': 'Redwood City-Redwood Shores',
          'branch_section': 'Redwood City - Redwood Shores Adult Nonfiction',
          'call_no': '658.4 SANDBERG',
          'num_of_copies': 1,
          'status': 'Due 03-30-16'},
         {'branch_name': 'Redwood City-Schaberg',
          'branch_section': 'Redwood City - Schaberg Nonfiction',
          'call_no': '658.4 SANDBERG',
          'num_of_copies': 1,
          'status': 'Due 04-06-16'},
         {'branch_name': 'San Carlos',
          'branch_section': 'San Carlos Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'Due 04-07-16'},
         {'branch_name': 'San Carlos',
          'branch_section': 'San Carlos Nonfiction',
          'call_no': 'SOC SCI ISSUE',
          'num_of_copies': 1,
          'status': 'Due 04-06-16'},
         {'branch_name': 'San Mateo-Hillsdale',
          'branch_section': 'San Mateo - Hillsdale Nonfiction',
          'call_no': '658.4092 SANDB',
          'num_of_copies': 1,
          'status': 'Due 04-04-16'},
         {'branch_name': 'San Mateo-Main',
          'branch_section': 'San Mateo Main Nonfiction 2nd Fl',
          'call_no': '658.4092 SANDB',
          'num_of_copies': 1,
          'status': 'Due 03-28-16'},
         {'branch_name': 'San Mateo-Main',
          'branch_section': 'San Mateo Main Nonfiction 2nd Fl',
          'call_no': '658.4092 SANDB',
          'num_of_copies': 1,
          'status': 'Due 03-13-16'},
         {'branch_name': 'Skyline College',
          'branch_section': 'Skyline College Circulating Collection',
          'call_no': 'HD6054.3 .S265 2013',
          'num_of_copies': 1,
          'status': 'Due 04-08-16'},
         {'branch_name': 'South San Francisco-Main',
          'branch_section': 'South San Francisco - Main Nonfiction',
          'call_no': '658.4 SAN',
          'num_of_copies': 1,
          'status': 'Due 04-02-16'}
    ]

    def test_create_search_url(self):
        super(TestSMCLLibraryAvailabilitySearch, self).test_create_search_url()

class TestSFPLLibraryAvailabilitySearch(_TestBaseBibliocommonsAvailabilitySearch):
    availability_search_cls = availability_search.SFPLAvailabilitySearch
    availability_html = SFPL_AVAILABILITY_HTML

    expected_search_url = 'https://sfpl.bibliocommons.com/search?utf8=%E2%9C%93&t=smart&search_category=keyword&q=9780316234801&commit=Search'

    serp_html = """<div class="col-sm-5 text_right_sm availability_block">
                        <span class="label availability">
                    <span role="presentation" class="item_available" testid="item_availability">Available </span>
                    <a href="/item/show_circulation/2639275093?search_scope=CAL-SFPL" class="circInfo value underlined" id="circ_info_trigger_2639275093_0.592804757729004" role="button" testid="availability_details">in some locations</a>

            </span>
            <span class="label">

            </span>

      </div>"""

    expected_avail_url = 'https://sfpl.bibliocommons.com/item/show_circulation/2639275093.json?search_scope=CAL-SFPL'

    expected_avail_list = [
        {'branch_name': 'Bernal Heights Branch',
        'branch_section': 'BERNAL HEIGHTS BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'CHECK SHELF'},
        {'branch_name': 'Eureka Valley Branch',
        'branch_section': 'EUREKA VALLEY BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'CHECK SHELF'},
        {'branch_name': 'Ingleside Branch',
        'branch_section': 'INGLESIDE BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'CHECK SHELF'},
        {'branch_name': 'Main Library',
        'branch_section': 'MAIN - 4th Floor',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'CHECK SHELF'},
        {'branch_name': 'Mission Bay Branch',
        'branch_section': 'MISSION BAY BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 2,
        'status': 'CHECK SHELF'},
        {'branch_name': 'Mission Branch',
        'branch_section': 'MISSION  BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'CHECK SHELF'},
        {'branch_name': 'Ortega Branch',
        'branch_section': 'ORTEGA BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'CHECK SHELF'},
        {'branch_name': 'Park Branch',
        'branch_section': 'PARK BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'CHECK SHELF'},
        {'branch_name': 'Parkside Branch',
        'branch_section': 'PARKSIDE BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'CHECK SHELF'},
        {'branch_name': 'Portola Branch',
        'branch_section': 'PORTOLA BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'CHECK SHELF'},
        {'branch_name': 'Western Addition Branch',
        'branch_section': 'WESTERN ADDITION BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'CHECK SHELF'},
        {'branch_name': 'Anza Branch',
        'branch_section': 'ANZA BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'Due 03-26-16'},
        {'branch_name': 'Bayview Branch',
        'branch_section': 'BAYVIEW BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'ON HOLDSHELF'},
        {'branch_name': 'Glen Park Branch',
        'branch_section': 'GLEN PARK BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'MISSING'},
        {'branch_name': 'Golden Gate Valley Branch',
        'branch_section': 'GOLDEN GATE VALLEY BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'Due 02-27-16'},
        {'branch_name': 'Main Library',
        'branch_section': 'MAIN - 4th Floor',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'Due 04-09-16'},
        {'branch_name': 'Marina Branch',
        'branch_section': 'MARINA BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'Due 04-04-16'},
        {'branch_name': 'Merced Branch',
        'branch_section': 'MERCED -- NEW BOOKS',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'Due 03-22-16'},
        {'branch_name': 'Mission Branch',
        'branch_section': 'MISSION  BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'LOST AND PAID'},
        {'branch_name': 'Noe Valley Branch',
        'branch_section': 'NOE VALLEY BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'IN TRANSIT'},
        {'branch_name': 'North Beach Branch',
        'branch_section': 'NORTH BEACH BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'MISSING'},
        {'branch_name': 'Potrero Branch',
        'branch_section': 'POTRERO BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'DAMAGED/REPAIR'},
        {'branch_name': 'Presidio Branch',
        'branch_section': 'PRESIDIO BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'Due 04-05-16'},
        {'branch_name': 'Presidio Branch',
        'branch_section': 'PRESIDIO BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'Due 03-25-16'},
        {'branch_name': 'Richmond Branch',
        'branch_section': 'RICHMOND BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'ON HOLDSHELF'},
        {'branch_name': 'Sunset Branch',
        'branch_section': 'SUNSET BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'IN TRANSIT'},
        {'branch_name': 'Visitacion Valley Branch',
        'branch_section': 'VISITACION VALLEY BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'ON HOLDSHELF'},
        {'branch_name': 'West Portal Branch',
        'branch_section': 'WEST PORTAL BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'Due 04-03-16'},
        {'branch_name': 'Western Addition Branch',
        'branch_section': 'WESTERN ADDITION BRANCH',
        'call_no': '613.26 P4222g',
        'num_of_copies': 1,
        'status': 'Due 04-07-16'}
    ]

    def test_create_search_url(self):
        super(TestSFPLLibraryAvailabilitySearch, self).test_create_search_url()
